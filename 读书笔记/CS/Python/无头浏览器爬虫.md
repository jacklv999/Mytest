## 无头浏览器爬虫

##### 1. 使用无头浏览器

```python
from selenium import webdriver
from selenium.webdriver.chrome.options import Options
from webdriver_manager.chrome import ChromeDriverManager

options = Options()
options.add_argument(
    '--headless'
)
driver = webdriver.Chrome(
    ChromeDriverManager().install(),
    options=options
)
#打开指定页面
driver.get(
    "https://login.pkulaw.com"
)

# 关闭页面
driver.close()
# 退出浏览器
driver.quit()
```

##### 2. 实时可视化页面

将实时页面转换为 base64 图片, 然后在jupyter notebook中可视化

```python
import base64 
import numpy as np
from PIL import Image
import io
import matplotlib.pyplot as plt

tt = driver.get_screenshot_as_base64()


def stringToRGB(base64_string):
    imgdata = base64.b64decode(
        base64_string
    )
    image = Image.open(
        io.BytesIO(imgdata)
    )
    return np.array(image)

plt.imshow(stringToRGB(tt))
```

##### 3. 常见页面操作

- 刷新页面

    ```python
    driver.refresh()
    ```

- 输入信息

    ```python
    pt = drv.find_element_by_id(
        "txtSearch"
    )
    pt.send_keys("环保")
    ```

- 查看页面源代码

    ```python
    driver.page_source
    ```

- 点击按钮

    ```python
    btn = drv.find_element_by_id(
        "btn-search"
    )
    btn.click()
    ```

- 执行JS代码

    ```python
    drv.execute_script("code") 
    ```